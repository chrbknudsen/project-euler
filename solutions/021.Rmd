---
title: "Euler 21"
format: html
date: '2018-02-15'
---

[Amicable numbers](https://en.wikipedia.org/wiki/Amicable_numbers) are pairs of two different numbers, so that the sum of the proper divisors of each is
equal to the other number.

What is the sum of amicable numbers under 10000.

First all numbers under 10000
```{r eval = FALSE}
a <- c(1:10000)
```

Then the sum of the proper divisors of all of them:
```{r}
library(numbers)
b <- unlist(lapply(a, function(x) sum(divisors(x)[1:(length(divisors(x))-1)])))
```

These are the numbers that _can_ be amicable with the numbers in `a`.

Next the sum of the proper divisors of b:
```{r}
c <- unlist(lapply(b, function(x) sum(divisors(x)[1:(length(divisors(x))-1)])))
```

These are the numbers that _can_ be amicable with the numbers in `b`.

```{r}
# a <- a[a==c]
# a[a %in% b] |> sum()

```

In total - numbers in a _can_ be amicable with the numbers in b. And the numbers in `c` _can_ be amicable with 
the numbers in `b`. Therefore a number in a is amicable with an number in b, if it is equal to the number in c (with the
same index). Except for the fact that the two amicable numbers in a and be have to be different:

```{r}
answer <- sum(a[a==c & a!=b])
```
